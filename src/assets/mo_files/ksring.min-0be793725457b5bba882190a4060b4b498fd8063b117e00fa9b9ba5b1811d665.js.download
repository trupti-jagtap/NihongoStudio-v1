"use strict";var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.findInternal=function(t,i,n){t instanceof String&&(t=String(t));for(var e=t.length,s=0;s<e;s++){var r=t[s];if(i.call(n,r,s,t))return{i:s,v:r}}return{i:-1,v:void 0}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,i,n){t!=Array.prototype&&t!=Object.prototype&&(t[i]=n.value)},$jscomp.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:"undefined"!=typeof global&&null!=global?global:t},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(t,i,n,e){if(i){for(n=$jscomp.global,t=t.split("."),e=0;e<t.length-1;e++){var s=t[e];s in n||(n[s]={}),n=n[s]}(i=i(e=n[t=t[t.length-1]]))!=e&&null!=i&&$jscomp.defineProperty(n,t,{configurable:!0,writable:!0,value:i})}},$jscomp.polyfill("Array.prototype.find",function(t){return t||function(t,i){return $jscomp.findInternal(this,t,i).v}},"es6","es3");var KsRing=function(t,i,n,e,s,r){this.snap=t,this.index=i,this.id=n,this.ringData=e,this.sectorData=s,this.colors=r,this.canvasSize=400,this.center=this.canvasSize/2,this.radius=.8*this.canvasSize/2,this.tempArc=null,this.debug=!1};KsRing.prototype.animateRing=function(){this.n_endDeg=this.n_startDeg=this.n_endItems=this.n_startItems=this.n_counter=0,this.drawRing(),this.nextArc()},KsRing.prototype.drawRing=function(){this.drawArcFromTo(this.center,this.ringData.radius,0,359.999,"#eeeeee",this.ringData.width).attr({ring:this.id,level:"back",color:"#eeeeee",status:"off"})},KsRing.prototype.nextArc=function(){this.n_startDeg=this.n_endDeg,this.n_startItems=this.n_endItems,this.sectorData[this.n_counter].deg?this.n_endDeg=this.sectorData[this.n_counter].deg:(this.n_endDeg=this.n_startDeg+360*this.sectorData[this.n_counter].items/this.ringData.items,this.n_endItems=this.n_startItems+this.sectorData[this.n_counter].items),this.n_timing=this.ringData.timing*(this.n_endDeg-this.n_startDeg)/360,Snap.animate(this.n_startDeg,this.n_endDeg,function(t){this.tempArc&&this.tempArc.remove(),this.tempArc=this.drawArcFromTo(this.center,this.ringData.radius,this.n_startDeg,t,this.colors[this.sectorData[this.n_counter].level],this.ringData.width)}.bind(this),this.n_timing,mina.linear,this.drawPermaArc.bind(this))},KsRing.prototype.drawPermaArc=function(){if(this.tempArc&&this.tempArc.remove(),this.n_startDeg!=this.n_endDeg){var t,i=this.colors[this.sectorData[this.n_counter].level],n=this.drawArcFromTo(this.center,this.ringData.radius,this.n_startDeg,this.n_endDeg,i,this.ringData.width),e=this.sectorData[this.n_counter];for(t in e)e.hasOwnProperty(t)&&(this.debug&&console.log(t+" -> "+e[t]),n.attr(t,e[t]));n.attr({ring:this.id,color:i,status:"off"})}this.n_counter+=1,this.n_counter===this.sectorData.length?(i=new CustomEvent("ring_ready",{detail:{ring:this.id}}),document.body.dispatchEvent(i)):this.nextArc()},KsRing.prototype.drawArcFromTo=function(t,i,n,e,s,r){var o=180<e-n?1:0;90>n&&(n+=360),90>e&&(e+=360);var a=Math.PI*(n-90)/180;n=Math.PI*(e-90)/180,e=t+i*Math.cos(a),a=t+i*Math.sin(a);var h=t+i*Math.cos(n);t+=i*Math.sin(n),Math.round(h)==Math.round(e)&&Math.round(t)==Math.round(a)&&(h=Math.round(h)-.01),(i=this.snap.path("M"+e+","+a+" A"+i+","+i+" 0 "+o+",1 "+h+","+t)).attr({stroke:s,fill:"none",strokeWidth:r});var c=i.id;return i.click(function(){this.sectorClick(c)}.bind(this)),i},KsRing.prototype.getPathById=function(t){return Snap.selectAll("path").items.find(function(i){return i.id===t})},KsRing.prototype.sectorClick=function(t){t=this.getPathById(t),t=new CustomEvent("wheel_sector_clicked",{detail:{path:t}}),document.body.dispatchEvent(t)};