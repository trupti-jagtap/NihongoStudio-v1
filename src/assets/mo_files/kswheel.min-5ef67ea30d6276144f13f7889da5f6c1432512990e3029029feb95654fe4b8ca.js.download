"use strict";var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,o,i){t!=Array.prototype&&t!=Object.prototype&&(t[o]=i.value)},$jscomp.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:"undefined"!=typeof global&&null!=global?global:t},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var t=0;return function(o){return $jscomp.SYMBOL_PREFIX+(o||"")+t++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var t=$jscomp.global.Symbol.iterator;t||(t=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&$jscomp.defineProperty(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(t){var o=0;return $jscomp.iteratorPrototype(function(){return o<t.length?{done:!1,value:t[o++]}:{done:!0}})},$jscomp.iteratorPrototype=function(t){return $jscomp.initSymbolIterator(),(t={next:t})[$jscomp.global.Symbol.iterator]=function(){return this},t},$jscomp.makeIterator=function(t){$jscomp.initSymbolIterator();var o=t[Symbol.iterator];return o?o.call(t):$jscomp.arrayIterator(t)};var KsWheel=function(t,o,i,e,n,r,s){this.debug=!1,this.id=t,this.snap=Snap("#"+o),this.rings=i,this.sectorData=e,this.onColors=n,this.offColors=r,this.errors=[],this.highlightRings=s,this.shadow=this.snap.paper.filter(Snap.filter.shadow(0,0,"black",.5)),this.snap.attr({viewBox:"0 0 400 400"}),document.body.addEventListener("ring_ready",this.ringReady.bind(this),!1),this.ringsReady=[],this.rings.forEach(function(t,o){var i=this.sectorData[t.id].reduce(function(t,o){return t+o.items},0);i>t.count&&this.errors.push("<div>Ring id "+t.id+" count "+t.count+" does not match item totals "+i+"</div>"),new KsRing(this.snap,o,t.id,t,this.sectorData[t.id],this.offColors).animateRing()}.bind(this)),document.body.addEventListener("wheel_sector_clicked",this.sectorClicked.bind(this),!1)};KsWheel.prototype.ringReady=function(t){t=parseInt(t.detail.ring),this.ringsReady.push(t),this.ringsReady.length==this.rings.length&&(t=new CustomEvent("wheel_ready",{detail:{id:this.id}}),document.body.dispatchEvent(t))},KsWheel.prototype.sectorClicked=function(t){if(!this.animating){t=t.detail.path,this.debug&&console.log("Ring "+t.attr("ring")+" level "+t.attr("level")+" clicked");var o="on"===t.attr("status");this.resetSectors(),o||(this.highlightRings?this.highlightRing(t.attr("ring")):this.highlightSector(t,!0)),t=new CustomEvent(this.id+"_sector_clicked",{detail:{sector:t}}),document.body.dispatchEvent(t)}},KsWheel.prototype.resetSectors=function(){var t=new Snap.Matrix;t.scale(1,1,200,200),Snap.selectAll("path").forEach(function(o){"on"===o.attr("status")&&(this.animating=!0,o.animate({transform:t,stroke:o.attr("color")},500,mina.bounce,this.animationDone.bind(this)),o.attr({scale:1,filter:null,status:"off"}))}.bind(this))},KsWheel.prototype.highlightRing=function(t){for(var o=$jscomp.makeIterator(Snap.selectAll("path").items.filter(function(o){return o.attr("ring")==t})),i=o.next();!i.done;i=o.next())i=i.value,this.highlightSector(i,"back"==i.attr("level"))},KsWheel.prototype.highlightSector=function(t,o){t.appendTo(t.paper);var i=1+(8-t.attr("ring"))/50,e=new Snap.Matrix;e.scale(i,i,200,200),this.animating=!0,t.attr({scale:i,status:"on"}),o?(t.animate({transform:e},500,mina.bounce),t.attr({filter:this.shadow})):t.animate({transform:e,stroke:this.onColors[t.attr("level")]},500,mina.bounce,this.animationDone.bind(this))},KsWheel.prototype.animationDone=function(){this.animating=!1};